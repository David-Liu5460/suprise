<!doctype html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Fireworks 2026</title>
    <link rel="stylesheet" href="./style.css" />
  </head>
  <body>
    <canvas id="stage"></canvas>
    <div id="gate"></div>
    <audio id="bg-audio" src="./mp3/outputs_netease_259066.mp3" preload="auto" loop playsinline></audio>
    <script src="./game.js"></script>
    <script src="./script.js"></script>
    <script>
      (function(){
        var a = document.getElementById('bg-audio');
        
        // 尝试自动播放
        function tryPlay() {
          a.muted = false;
          var promise = a.play();
          
          if (promise !== undefined) {
            promise.then(function() {
              // 自动播放成功
              console.log("Audio autoplay started!");
            }).catch(function(error) {
              // 自动播放失败（通常是因为浏览器策略），回退到交互后播放
              console.log("Autoplay prevented. Waiting for user interaction.");
              
              function startAudio() {
                a.muted = false;
                a.play();
                // 移除监听器
                document.removeEventListener('click', startAudio);
                document.removeEventListener('touchstart', startAudio);
                document.removeEventListener('keydown', startAudio);
              }
              
              document.addEventListener('click', startAudio);
              document.addEventListener('touchstart', startAudio);
              document.addEventListener('keydown', startAudio);
            });
          }
        }

        if (document.readyState === 'complete' || document.readyState === 'interactive') {
          tryPlay();
        } else {
          document.addEventListener('DOMContentLoaded', tryPlay);
        }
      })();
    </script>
  </body>
  </html>
